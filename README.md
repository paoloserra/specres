# specres
Python script to estimate the spectral resolution of a data cube from its noise properties.

It assumes that the data cube is obtained by convolving a data cube with uncorrelated channels with a spectral convolution kernel `K`.

Spectra with signal should be excluded from the analysis by giving a detection mask cube in input (see below).

The script does the following:
- extracts a set of unique random spectra from the datacube and calculates the autocorrelation of each spectrum;
- reconstructs the spectral convolution kernel `K` from the mean autocorrelation `A` as `K = IFT{+/- sqrt[FT(A)]}`, including a sign disambiguation algorithm;
- calculates the area of the spectral convolution kernel `K`;
- for reference, compares the mean autocorrelation `A` with the autocorrelation that would be generated by a set of analytical kernels selected by the user.

```
usage: specres.py [-h] -c CUBE [-m MASK] [-ns NR_SPEC] [-nc NR_CHAN] [-sk SINC_KERNEL [SINC_KERNEL ...]] [-gk GAUSS_KERNEL [GAUSS_KERNEL ...]] [-hk HANNING_KERNEL [HANNING_KERNEL ...]]
                  [-bk BOX_KERNEL [BOX_KERNEL ...]]

optional arguments:
  -h, --help            show this help message and exit
  -c CUBE, --cube CUBE  Input FITS cube.
  -m MASK, --mask MASK  Optional FITS detection mask. Spectra including detected voxels are excluded from the analysis.
  -ns NR_SPEC, --nr-spec NR_SPEC
                        Number of unique random spectra to be extracted from the input FITS cube. Default is 1000.
  -nc NR_CHAN, --nr-chan NR_CHAN
                        Number of channels per spectrum. Default is 0 = all channels.
  -sk SINC_KERNEL [SINC_KERNEL ...], --sinc-kernel SINC_KERNEL [SINC_KERNEL ...]
                        Space separated list of scales for comparison Sinc kernels.
  -gk GAUSS_KERNEL [GAUSS_KERNEL ...], --gauss-kernel GAUSS_KERNEL [GAUSS_KERNEL ...]
                        Space separated list of widths for comparison Gaussian kernels.
  -hk HANNING_KERNEL [HANNING_KERNEL ...], --hanning-kernel HANNING_KERNEL [HANNING_KERNEL ...]
                        Space separated list of widths for comparison Hanning kernels (only odd numbers will be considered).
  -bk BOX_KERNEL [BOX_KERNEL ...], --box-kernel BOX_KERNEL [BOX_KERNEL ...]
                        Space separated list of widths for comparison Box kernels (only odd numbers will be considered).
```
